{% extends "plantilla.html" %}
{% block content %}
<div class="page-header">
    <div class="page-block">
        <div class="row align-items-center">
            <div class="col-md-12">
                <div class="page-header-title">
                    <h5 class="m-b-10">Centrales</h5>
                </div>
                <ul class="breadcrumb">
                    <li class="breadcrumb-item" aria-current="page">
                        <a href="{% url 'tipoGeneracion' %}" class="pc-head-link ms-0">
                            Tipos de Generación
                        </a>
                    </li>
                    <li class="breadcrumb-item" aria-current="page">Lista de Centrales Fotovoltaicas</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="col-md-12">
    <div class="page-header-title">
      <h2 class="mb-0">Lista de Plantas Fotovoltaicas</h2>
    </div>
</div>
<br>
<div class="row">
    <div class="col-sm-12">
        <div class="row">
            <div class="col-md-10">
                <a href="{% url 'fotovoltaica_create' %}" class="btn btn-success mb-3"><i class="ti ti-plus"></i>Agregar</a>
            </div>
            <div class="col-md-2">
                <span class="d-inline-block" tabindex="0" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-content="Mostrar Detalles">
                    <button onclick="mostrarDetalles();" id="btn_ver_detalles" class="btn btn-outline-primary btn-circle d-flex justify-content-center align-items-center">
                        <i class="ti ti-eye"></i>
                    </button>
                </span>

                <span class="d-inline-block" tabindex="0" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-content="Ocultar Detalles">
                    <button onclick="ocultarDetalles();" class="btn btn-outline-success btn-circle d-flex justify-content-center align-items-center" id="btn_ocultar_detalles" style="display:none;">
                        <i class="fa fa-eye-slash"></i>
                    </button>
                </span>
            </div>
        </div>
        <br>
        <div class="card">
            <div class="card-body">
                <div class="dt-responsive table-responsive">
                    <table id="tbl-fotovoltaica" class="table table-hover table-striped">
                        <thead class="table-lcoe">
                            <tr>
                                <th class="principal">Nombre</th>
                                <th class="secundario">Año Ingreso</th>
                                <th class="secundario">N° Paneles</th>
                                <th class="secundario">Sistema</th>
                                <th class="principal">Potencia Nominal</th>
                                <th class="secundario">Potencia Efectiva</th>
                                <th class="principal">Energia Anual Producida</th>
                                <th class="secundario">Energia Bruta</th>
                                <th class="principal">Factor Planta</th>
                                <th class="principal">Vida Útil</th>
                                <th class="principal">Degradación</th>
                                <th class="principal">Inversión</th>
                                <th class="principal">Capital Propio</th>
                                <th class="secundario">Acreedor</th>
                                <th class="principal">Deuda</th>
                                <th class="principal">Tasa Interes Anual</th>
                                <th class="principal">Tasa Interes Periodo</th>
                                <th class="principal">Periodos por año</th>
                                <th class="principal">Años de pago</th>
                                <th class="secundario">Total periodos</th>
                                <th class="secundario">Años de gracia</th>
                                <th class="secundario">Periodos de gracia</th>
                                <th class="secundario">Periodos de pago</th>
                                <th class="secundario">Años de pago</th>
                                <th class="principal">Costos Variables</th>
                                <th class="principal">Costos de Producción</th>
                                <th class="principal">Costos OMA</th>
                                <th class="principal">Costos Anual OMA Inversión</th>
                                <th class="principal">Costos Anual OMA/ MW</th>
                                <th class="secundario">Beta</th>
                                <th class="secundario">Margen de Intermediación Bancaria </th>
                                <th class="secundario">Indice de Inflación</th>
                                <th class="secundario">Tasa Interes de Economia</th>
                                <th class="secundario">Riesgo País</th>
                                <th class="secundario">Indice de Premio al Riesgo</th>
                                <th class="secundario">Tasa de Descuento Sin Riesgo</th>
                                <th class="secundario">Tasa de Descuento al Mercado</th>
                                <th class="secundario">Premio por el Riesgo Mercado</th>
                                <th class="secundario">Tasa de Impuestos</th>


                                <th class="principal">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for fotovoltaica in object_list %}
                            <tr>
                                <td class="principal">{{ fotovoltaica.central }}</td>
                                <td class="secundario">{{ fotovoltaica.anio_ingreso}}</td>
                                <td class="secundario">{{ fotovoltaica.numero_paneles }}</td>
                                <td class="secundario">{{ fotovoltaica.sistema }}</td>
                                <td class="principal">{{ fotovoltaica.potencia_nominal }}</td>
                                <td class="secundario">{{ fotovoltaica.potencia_efectiva }}</td>
                                <td class="principal">{{ fotovoltaica.energia_anual_producida }}</td>
                                <td class="secundario">{{ fotovoltaica.energia_bruta_calculada }}</td>
                                <td class="principal">{{ fotovoltaica.factor_planta }}</td>
                                <td class="principal">{{ fotovoltaica.vida_util }}</td>
                                <td class="principal">{{ fotovoltaica.degradacion}}</td>
                                <td class="principal">{{ fotovoltaica.inversion_total }}</td>
                                <td class="principal">{{ fotovoltaica.capital_propio }}</td>
                                <td class="secundario">{{ fotovoltaica.acreedor }}</td>
                                <td class="principal">{{ fotovoltaica.deuda }}</td>
                                <td class="principal">{{ fotovoltaica.tasa_interes_anual }}</td>
                                <td class="principal">{{ fotovoltaica.tasa_interes_periodo }}</td>
                                <td class="principal">{{ fotovoltaica.periodos_por_anio }}</td>
                                <td class="principal">{{ fotovoltaica.anios_pago_total }}</td>
                                <td class="secundario">{{ fotovoltaica.total_periodos }}</td>
                                <td class="secundario">{{ fotovoltaica.anios_gracia }}</td>
                                <td class="secundario">{{ fotovoltaica.periodos_gracia }}</td>
                                <td class="secundario">{{ fotovoltaica.periodos_pago }}</td>
                                <td class="secundario">{{ fotovoltaica.anios_pago }}</td>
                                <td class="principal">{{ fotovoltaica.costo_variable }}</td>
                                <td class="principal">{{ fotovoltaica.costo_produccion }}</td>
                                <td class="principal">{{ fotovoltaica.costo_anual_oma }}</td>
                                <td class="principal">{{ fotovoltaica.costo_anual_oma_inversion }}</td>
                                <td class="principal">{{ fotovoltaica.costo_anual_oma_mw }}</td>
                                <td class="secundario">{{ fotovoltaica.beta }}</td>
                                <td class="secundario">{{ fotovoltaica.margen_intermediacion }}</td>
                                <td class="secundario">{{ fotovoltaica.inflacion }}</td>
                                <td class="secundario">{{ fotovoltaica.economia }}</td>
                                <td class="secundario">{{ fotovoltaica.riesgo }}</td>
                                <td class="secundario">{{ fotovoltaica.indice_premio }}</td>
                                <td class="secundario">{{ fotovoltaica.sin_riesgo }}</td>
                                <td class="secundario">{{ fotovoltaica.tasa_mercado }}</td>
                                <td class="secundario">{{ fotovoltaica.premio_riesgo_mercado }}</td>
                                <td class="secundario">{{ fotovoltaica.impuesto }}</td>

                                <td>
                                    <span class="d-inline-block mb-2" tabindex="0" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-content="Editar">
                                        <a href="{% url 'fotovoltaica_update' fotovoltaica.pk%}" class="btn btn-warning btn-sm btn-circle"><i class="ti ti-pencil me-1" name="editar"></i></a>
                                    </span>
                                    <form id="form-eliminar-{{ central.pk }}" method="POST" action="{% url 'fotovoltaica_delete' fotovoltaica.pk %}" class="d-inline">
                                        {% csrf_token %}
                                        <span class="d-inline-block mb-2" tabindex="0" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-content="Eliminar">
                                            <button type="button" onclick="confirmarEliminacion('{{ central.pk }}')" class="btn btn-danger btn-sm btn-circle">
                                                <i class="ti ti-trash me-1"></i>
                                            </button>
                                        </span>
                                    </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    $(".secundario").hide();

    function mostrarDetalles(){
        $(".secundario").fadeIn();
        $("#btn_ver_detalles").hide();
        $("#btn_ocultar_detalles").fadeIn();
    }

    function ocultarDetalles(){
        $(".secundario").hide();
        $("#btn_ver_detalles").fadeIn();
        $("#btn_ocultar_detalles").hide();
    }

    ocultarDetalles();

    document.addEventListener("DOMContentLoaded", function () {
        let table = new DataTable('#tbl-fotovoltaica', {
            language: {
                url: "https://cdn.datatables.net/plug-ins/1.10.25/i18n/Spanish.json"
            },
            dom:
                "<'row'<'col-sm-8 d-flex align-items-center'B><'col-md-4 d-flex justify-content-end'f>>" +  // Botones + buscador
                "<'row'<'col-sm-6'l>>" +                                          
                "<'row'<'col-sm-12'tr>>" +                                             // Tabla
                "<'row mt-2'<'col-md-6'i><'col-md-6 d-flex justify-content-end'p>>",   
            buttons: [
                { extend: 'copy', text: '<i class="fa fa-copy"></i> Copiar', className: 'custom-blue' },
                { extend: 'csv', text: '<i class="fa fa-file-csv"></i> CSV', className: 'custom-blue' },
                { extend: 'excel', text: '<i class="fa fa-file-excel"></i> Excel', className: 'custom-blue' },
                { extend: 'pdf', text: '<i class="fa fa-file-pdf"></i> PDF', className: 'custom-blue' },
                { extend: 'print', text: '<i class="fa fa-print"></i> Imprimir', className: 'custom-blue' }
            ]
        });
    });
</script>
{% endblock %}
